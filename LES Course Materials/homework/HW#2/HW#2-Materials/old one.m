u1_filter_2n = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
u1_filter_2n(i,j,k)= u1_filter_2n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end
                                                                                                                                   

for i=2:ni-1
for j=1
for k=2:nk-1
u1_filter_2n(i,j,k)= u1_filter_2n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
u1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=49
for k=2:nk-1
u1_filter_2n(i,j,k)= u1_filter_2n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
u1_3d(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=2:nk-1
u1_filter_2n(i,j,k)= u1_filter_2n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=2:nk-1
u1_filter_2n(i,j,k)= u1_filter_2n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=1
u1_filter_2n(i,j,k)= u1_filter_2n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + u1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
u1_filter_2n(i,j,k)= u1_filter_2n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + u1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end











%start double filter with n=2%

u1_filter_2n_double = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_filter_2n(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end















for i=2:ni-1
for j=1
for k=2:nk-1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 


for i=1
for j=1
for k=2:nk-1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=96
for j=1
for k=2:nk-1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 


for i=2:ni-1
for j=1
for k=1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*dx*((y(j+1)-y(j))/2)*(dz/2) +  u1_filter_2n(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*(dz/2) +  u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*(dz/2) +...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*(dz/2) +  u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*(dz/2)+  u1_filter_2n(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*(dz/2) +  u1_filter_2n(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*(dz/2)+ u1_filter_2n(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=1
for k=96
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*dx*((y(j+1)-y(j))/2)*(dz/2) + u1_filter_2n(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2  + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*(dz/2) + u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*(dz/2) + u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*(dz/2) + u1_filter_2n(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*(dz/2) + u1_filter_2n(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*(dz/2) + u1_filter_2n(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 ) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 



for i=2:ni-1
for j=49
for k=2:nk-1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end


for i=1
for j=49
for k=2:nk-1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(2*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end


for i=96
for j=49
for k=2:nk-1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=49
for k=1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*dx*((y(j)-y(j-1))/2)*(dz/2) +  u1_filter_2n(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*(dz/2) +  u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*(dz/2) +  u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*(dz/2) +  u1_filter_2n(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*(dz/2)+  u1_filter_2n(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*(dz/2) +  u1_filter_2n(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(2*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end



for i=2:ni-1
for j=49
for k=96
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 +  ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 ) ...
/(2*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end



for i=1
for j=2:nj-1
for k=2:nk-1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_filter_2n(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end




for i=1
for j=2:nj-1
for k=1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_filter_2n(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_filter_2n(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_filter_2n(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u1_filter_2n(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2  + u1_filter_2n(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=96
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  ...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 ) ...
/(dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end



for i=96
for j=2:nj-1
for k=2:nk-1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_filter_2n(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_filter_2n(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_filter_2n(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end


for i=96
for j=2:nj-1
for k=1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_filter_2n(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_filter_2n(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_filter_2n(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=96
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_filter_2n(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  ...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 ) ...
/(dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end



for i=2:ni-1
for j=2:nj-1
for k=1
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_filter_2n(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_filter_2n(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + u1_filter_2n(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u1_filter_2n(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u1_filter_2n(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_filter_2n(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_filter_2n(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
u1_filter_2n_double(i,j,k)= u1_filter_2n_double(i,j,k)+... 
(u1_filter_2n(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_filter_2n(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u1_filter_2n(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_filter_2n(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_filter_2n(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + u1_filter_2n(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u1_filter_2n(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_filter_2n(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u1_filter_2n(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u1_filter_2n(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u1_filter_2n(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u1_filter_2n(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u1_filter_2n(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u1_filter_2n(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_filter_2n(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u1_filter_2n(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end


u2_filter_2n = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
u2_filter_2n(i,j,k)= u2_filter_2n(i,j,k)+... 
(u2_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u2_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u2_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
u2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u2_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u2_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u2_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u2_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u2_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + u2_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u2_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + u2_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end
                                                                                                                                   

for i=2:ni-1
for j=1
for k=2:nk-1
u2_filter_2n(i,j,k)= u2_filter_2n(i,j,k)+... 
(u2_3d(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + u2_3d(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
u2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + u2_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=49
for k=2:nk-1
u2_filter_2n(i,j,k)= u2_filter_2n(i,j,k)+... 
(u2_3d(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + u2_3d(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
u2_3d(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + u2_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=2:nk-1
u2_filter_2n(i,j,k)= u2_filter_2n(i,j,k)+... 
(u2_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u2_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u2_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u2_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u2_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u2_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u2_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=2:nk-1
u2_filter_2n(i,j,k)= u2_filter_2n(i,j,k)+... 
(u2_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u2_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u2_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u2_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u2_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u2_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u2_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u2_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u2_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u2_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=1
u2_filter_2n(i,j,k)= u2_filter_2n(i,j,k)+... 
(u2_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u2_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u2_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u2_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u2_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + u2_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u2_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u2_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u2_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u2_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u2_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
u2_filter_2n(i,j,k)= u2_filter_2n(i,j,k)+... 
(u2_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u2_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u2_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u2_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u2_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + u2_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u2_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u2_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u2_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u2_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u2_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u2_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end


u3_filter_2n = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
u3_filter_2n(i,j,k)= u3_filter_2n(i,j,k)+... 
(u3_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u3_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u3_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
u3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u3_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u3_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u3_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u3_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u3_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + u3_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
u3_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + u3_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end
                                                                                                                                   

for i=2:ni-1
for j=1
for k=2:nk-1
u3_filter_2n(i,j,k)= u3_filter_2n(i,j,k)+... 
(u3_3d(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + u3_3d(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
u3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + u3_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=49
for k=2:nk-1
u3_filter_2n(i,j,k)= u3_filter_2n(i,j,k)+... 
(u3_3d(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + u3_3d(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
u3_3d(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + u3_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=2:nk-1
u3_filter_2n(i,j,k)= u3_filter_2n(i,j,k)+... 
(u3_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u3_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u3_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u3_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u3_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u3_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u3_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=2:nk-1
u3_filter_2n(i,j,k)= u3_filter_2n(i,j,k)+... 
(u3_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u3_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u3_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u3_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u3_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u3_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u3_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u3_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u3_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u3_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=1
u3_filter_2n(i,j,k)= u3_filter_2n(i,j,k)+... 
(u3_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u3_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u3_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u3_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u3_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + u3_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u3_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u3_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u3_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u3_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u3_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
u3_filter_2n(i,j,k)= u3_filter_2n(i,j,k)+... 
(u3_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u3_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
u3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u3_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u3_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u3_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
u3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + u3_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
u3_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u3_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
u3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u3_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  u3_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
u3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  u3_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  u3_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end


v1_filter_2n = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
v1_filter_2n(i,j,k)= v1_filter_2n(i,j,k)+... 
(v1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + v1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + v1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
v1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v1_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + v1_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
v1_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + v1_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end
                                                                                                                                   

for i=2:ni-1
for j=1
for k=2:nk-1
v1_filter_2n(i,j,k)= v1_filter_2n(i,j,k)+... 
(v1_3d(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + v1_3d(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
v1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + v1_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=49
for k=2:nk-1
v1_filter_2n(i,j,k)= v1_filter_2n(i,j,k)+... 
(v1_3d(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + v1_3d(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
v1_3d(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + v1_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=2:nk-1
v1_filter_2n(i,j,k)= v1_filter_2n(i,j,k)+... 
(v1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=2:nk-1
v1_filter_2n(i,j,k)= v1_filter_2n(i,j,k)+... 
(v1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=1
v1_filter_2n(i,j,k)= v1_filter_2n(i,j,k)+... 
(v1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + v1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
v1_filter_2n(i,j,k)= v1_filter_2n(i,j,k)+... 
(v1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + v1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v1_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end


v2_filter_2n = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
v2_filter_2n(i,j,k)= v2_filter_2n(i,j,k)+... 
(v2_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + v2_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + v2_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
v2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v2_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v2_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v2_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v2_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v2_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + v2_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
v2_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + v2_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end
                                                                                                                                   

for i=2:ni-1
for j=1
for k=2:nk-1
v2_filter_2n(i,j,k)= v2_filter_2n(i,j,k)+... 
(v2_3d(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + v2_3d(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
v2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + v2_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=49
for k=2:nk-1
v2_filter_2n(i,j,k)= v2_filter_2n(i,j,k)+... 
(v2_3d(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + v2_3d(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
v2_3d(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + v2_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=2:nk-1
v2_filter_2n(i,j,k)= v2_filter_2n(i,j,k)+... 
(v2_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v2_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v2_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v2_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v2_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v2_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v2_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=2:nk-1
v2_filter_2n(i,j,k)= v2_filter_2n(i,j,k)+... 
(v2_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v2_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v2_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v2_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v2_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v2_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v2_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v2_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v2_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v2_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=1
v2_filter_2n(i,j,k)= v2_filter_2n(i,j,k)+... 
(v2_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v2_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v2_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v2_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v2_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + v2_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v2_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v2_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v2_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v2_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v2_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
v2_filter_2n(i,j,k)= v2_filter_2n(i,j,k)+... 
(v2_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v2_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v2_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v2_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v2_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v2_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v2_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + v2_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v2_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v2_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v2_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v2_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v2_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v2_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v2_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v2_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v2_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v2_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end


v3_filter_2n = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
v3_filter_2n(i,j,k)= v3_filter_2n(i,j,k)+... 
(v3_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + v3_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + v3_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
v3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v3_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v3_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v3_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v3_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v3_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + v3_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
v3_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + v3_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end
                                                                                                                                   

for i=2:ni-1
for j=1
for k=2:nk-1
v3_filter_2n(i,j,k)= v3_filter_2n(i,j,k)+... 
(v3_3d(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + v3_3d(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
v3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + v3_3d(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=49
for k=2:nk-1
v3_filter_2n(i,j,k)= v3_filter_2n(i,j,k)+... 
(v3_3d(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + v3_3d(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
v3_3d(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + v3_3d(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=2:nk-1
v3_filter_2n(i,j,k)= v3_filter_2n(i,j,k)+... 
(v3_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v3_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v3_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v3_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v3_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v3_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v3_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=2:nk-1
v3_filter_2n(i,j,k)= v3_filter_2n(i,j,k)+... 
(v3_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v3_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v3_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + v3_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v3_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v3_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + v3_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + v3_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v3_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + v3_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=1
v3_filter_2n(i,j,k)= v3_filter_2n(i,j,k)+... 
(v3_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v3_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v3_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v3_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v3_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + v3_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v3_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v3_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v3_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v3_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v3_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
v3_filter_2n(i,j,k)= v3_filter_2n(i,j,k)+... 
(v3_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + v3_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
v3_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v3_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v3_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v3_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
v3_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + v3_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
v3_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + v3_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
v3_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v3_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v3_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  v3_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
v3_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  v3_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
v3_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  v3_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end



%start filtering with n=4%

u1_filter_4n = zeros(96,49,96);
for i=3:ni-2
for j=3:nj-2
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(16*dx*dz*(y(j+2)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=3:ni-2
for j=2
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz)  ...
/(16*dx*dz*(y(j+2)-y(j-1))) ;                                                                                                                                        
end
end
end


for i=1
for j=2
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz)  ...
/(8*dx*dz*(y(j+2)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2
for j=2
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz)  ...
/(12*dx*dz*(y(j+2)-y(j-1))) ;                                                                                                                                        
end
end
end


for i=96
for j=2
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz)  ...
/(8*dx*dz*(y(j+2)-y(j-1))) ;                                                                                                                                        
end
end
end


for i=95
for j=2
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-1))/2)*dz )  ...
/(12*dx*dz*(y(j+2)-y(j-1))) ;                                                                                                                                        
end
end
end


for i=3:ni-2
for j=1
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz )  ...
/(16*dx*dz*(y(j+2)-y(j))) ;                                                                                                                                        
end
end
end








for i=1
for j=1
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz )  ...
/(8*dx*dz*(y(j+2)-y(j))) ;                                                                                                                                        
end
end
end

for i=2
for j=1
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz )  ...
/(12*dx*dz*(y(j+2)-y(j))) ;                                                                                                                                        
end
end
end


for i=96
for j=1
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz )  ...
/(8*dx*dz*(y(j+2)-y(j))) ;                                                                                                                                        
end
end
end



for i=95
for j=1
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz )  ...
/(12*dx*dz*(y(j+2)-y(j))) ;                                                                                                                                        
end
end
end

















for i=3:ni-2
for j=48
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+1)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(16*dx*dz*(y(j+1)-y(j-2))) ;                                                                                                                                        
end
end
end

for i=1
for j=48
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+1)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz ) ...
/(8*dx*dz*(y(j+1)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=2
for j=48
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+1)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(12*dx*dz*(y(j+1)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=96
for j=48
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i-1,j+1,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(8*dx*dz*(y(j+1)-y(j-2))) ;                                                                                                                                        
end
end
end



for i=95
for j=48
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+1)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+1)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(12*dx*dz*(y(j+1)-y(j-2))) ;                                                                                                                                        
end
end
end



for i=3:ni-2
for j=49
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(16*dx*dz*(y(j)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=1
for j=49
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(8*dx*dz*(y(j)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=2
for j=49
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(12*dx*dz*(y(j)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=96
for j=49
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i-1,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(8*dx*dz*(y(j)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=95
for j=49
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(12*dx*dz*(y(j)-y(j-2))) ;                                                                                                                                        
end
end
end



for i=2
for j=3:nj-2
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz ) ...
/(12*dx*dz*(y(j+2)-y(j-2))) ;                                                                                                                                        
end
end
end



for i=1
for j=3:nj-2
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(8*dx*dz*(y(j+2)-y(j-2))) ;                                                                                                                                        
end
end
end



for i=95
for j=3:nj-2
for k=3:nj-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(12*dx*dz*(y(j+2)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=96
for j=3:nj-2
for k=3:nk-2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(8*dx*dz*(y(j+2)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=3:ni-2
for j=3:nj-2
for k=96
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + ...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz + ...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + ...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + ...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz +   ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz +...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz +   ...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz +   ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +   ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz +   ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +   ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz +   ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz ) ...
/(8*dx*dz*(y(j+2)-y(j-2))) ;                                                                                                                                        
end
end
end


for i=3:ni-2
for j=3:nj-2
for k=95
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz +  u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz +  u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +  u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-1,j,k-2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz  + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k-2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz +  u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz/2 +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz/2 +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz + u1_3d(i-1,j+1,k-2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz +  u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz/2 +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz + u1_3d(i-2,j+1,k-2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz +  u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz +  u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz/2 +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz/2 +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k-2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz/2 +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 +  ...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz +  u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz/2 +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz/2 +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i+2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz  + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-1,j+2,k-2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz +  u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz/2 +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz + u1_3d(i-2,j+2,k-2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz +  u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz/2 +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz +  u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz/2 +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz/2 +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 )  ...
/(12*dx*dz*(y(j+2)-y(j-2))) ;                                                                                                                                        
end
end
end




for i=3:ni-2
for j=3:nj-2
for k=1
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz/2 +  u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz/2 +  u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz/2  + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(8*dx*dz*(y(j+2)-y(j-2))) ;                                                                                                                                        
end
end
end



for i=3:ni-2
for j=3:nj-2
for k=2
u1_filter_4n(i,j,k)= u1_filter_4n(i,j,k)+... 
(u1_3d(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz +  u1_3d(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +  ...
u1_3d(i+1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz +  u1_3d(i+1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i+2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + u1_3d(i+2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i+2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-1,j,k)*dx*((y(j+1)-y(j-1))/2)*dz +  u1_3d(i-1,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+2)*dx*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-1,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i-2,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +  u1_3d(i-2,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+2)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + u1_3d(i-2,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz +...
u1_3d(i,j+1,k)*dx*((y(j+2)-y(j))/2)*dz +  u1_3d(i,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i+1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz +  u1_3d(i+1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +...
u1_3d(i+2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz +  u1_3d(i+2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i+2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i-1,j+1,k)*dx*((y(j+2)-y(j))/2)*dz +  u1_3d(i-1,j+1,k-1)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+2)*dx*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-1,j+1,k+1)*dx*((y(j+2)-y(j))/2)*dz +  ...
u1_3d(i-2,j+1,k)*(dx/2)*((y(j+2)-y(j))/2)*dz +  u1_3d(i-2,j+1,k-1)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+2)*(dx/2)*((y(j+2)-y(j))/2)*dz/2 + u1_3d(i-2,j+1,k+1)*(dx/2)*((y(j+2)-y(j))/2)*dz +...
u1_3d(i,j-1,k)*dx*((y(j)-y(j-2))/2)*dz +  u1_3d(i,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz + u1_3d(i-1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz +  u1_3d(i-2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-1,k)*dx*((y(j)-y(j-2))/2)*dz +  u1_3d(i+1,j-1,k-1)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+2)*dx*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-1,k+1)*dx*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-1,k)*(dx/2)*((y(j)-y(j-2))/2)*dz + u1_3d(i+2,j-1,k-1)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+2)*(dx/2)*((y(j)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-1,k+1)*(dx/2)*((y(j)-y(j-2))/2)*dz +  ...
u1_3d(i,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz +  u1_3d(i,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz +  u1_3d(i+1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i+2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  u1_3d(i+2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i+2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-1,j+2,k)*dx*((y(j+2)-y(j+1))/2)*dz +  u1_3d(i-1,j+2,k-1)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+2)*dx*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-1,j+2,k+1)*dx*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i-2,j+2,k)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  u1_3d(i-2,j+2,k-1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+2)*(dx/2)*((y(j+2)-y(j+1))/2)*dz/2 + u1_3d(i-2,j+2,k+1)*(dx/2)*((y(j+2)-y(j+1))/2)*dz +  ...
u1_3d(i,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz +  u1_3d(i,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz +  u1_3d(i+1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i+2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i+2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i+2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-1,j-2,k)*dx*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-1,j-2,k-1)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+2)*dx*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-1,j-2,k+1)*dx*((y(j-1)-y(j-2))/2)*dz +  ...
u1_3d(i-2,j-2,k)*(dx/2)*((y(j-1)-y(j-2))/2)*dz + u1_3d(i-2,j-2,k-1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+2)*(dx/2)*((y(j-1)-y(j-2))/2)*dz/2 + u1_3d(i-2,j-2,k+1)*(dx/2)*((y(j-1)-y(j-2))/2)*dz )  ...
/(12*dx*dz*(y(j+2)-y(j-2))) ;                                                                                                                                        
end
end
end


%u1_filter_4n_y=u1_filter_4n(48,1:nj,48);
%u1_filter_2n_double_y=u1_filter_2n_double(48,1:nj,48);
%u1_filter_2n_y=u1_filter_2n(48,1:nj,48);
%u1_3d_y=u1_3d(48,1:nj,48);
%plot(y,u1_filter_2n_double_y);
%hold on;
%plot(y,u1_filter_2n_y);
%hold on;
%plot(y,u1_3d_y);
%hold on;
%plot(y,u1meanj);
%hold on;
%plot(y,u1_filter_4n_y);
%hold on;


%Question 3%


U1_V1(1:ni,1:nj,1:nk)=0;
for k=1:nk
for j=1:nj
for i=1:ni
    U1_V1(i,j,k)=u1_3d(i,j,k)*v1_3d(i,j,k);
end
end
end
U1_V1(i,j,k)=0;
U1_V1_filter_2n = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
U1_V1_filter_2n(i,j,k)= U1_V1_filter_2n(i,j,k)+... 
(U1_V1(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + U1_V1(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + U1_V1(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
U1_V1(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U1_V1(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U1_V1(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U1_V1(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U1_V1(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U1_V1(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U1_V1(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + U1_V1(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
U1_V1(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + U1_V1(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end
                                                                                                                                   

for i=2:ni-1
for j=1
for k=2:nk-1
U1_V1_filter_2n(i,j,k)= U1_V1_filter_2n(i,j,k)+... 
(U1_V1(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + U1_V1(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
U1_V1(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + U1_V1(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=49
for k=2:nk-1
U1_V1_filter_2n(i,j,k)= U1_V1_filter_2n(i,j,k)+... 
(U1_V1(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + U1_V1(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
U1_V1(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + U1_V1(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=2:nk-1
U1_V1_filter_2n(i,j,k)= U1_V1_filter_2n(i,j,k)+... 
(U1_V1(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U1_V1(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U1_V1(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U1_V1(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U1_V1(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U1_V1(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U1_V1(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U1_V1(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=2:nk-1
U1_V1_filter_2n(i,j,k)= U1_V1_filter_2n(i,j,k)+... 
(U1_V1(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U1_V1(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U1_V1(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U1_V1(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U1_V1(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U1_V1(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U1_V1(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U1_V1(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U1_V1(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U1_V1(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U1_V1(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=1
U1_V1_filter_2n(i,j,k)= U1_V1_filter_2n(i,j,k)+... 
(U1_V1(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U1_V1(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U1_V1(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U1_V1(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U1_V1(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U1_V1(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + U1_V1(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U1_V1(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U1_V1(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U1_V1(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U1_V1(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U1_V1(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U1_V1(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U1_V1(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U1_V1(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
U1_V1_filter_2n(i,j,k)= U1_V1_filter_2n(i,j,k)+... 
(U1_V1(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U1_V1(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U1_V1(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U1_V1(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U1_V1(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U1_V1(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U1_V1(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + U1_V1(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U1_V1(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U1_V1(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U1_V1(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U1_V1(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U1_V1(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U1_V1(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U1_V1(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U1_V1(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U1_V1(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U1_V1(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end




U2_V2(1:ni,1:nj,1:nk)=0;
for k=1:nk
for j=1:nj
for i=1:ni
    U2_V2(i,j,k)=u2_3d(i,j,k)*v2_3d(i,j,k);
end
end
end
U2_V2(i,j,k)=0;
U2_V2_filter_2n = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
U2_V2_filter_2n(i,j,k)= U2_V2_filter_2n(i,j,k)+... 
(U2_V2(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + U2_V2(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + U2_V2(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
U2_V2(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U2_V2(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U2_V2(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U2_V2(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U2_V2(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U2_V2(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U2_V2(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + U2_V2(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
U2_V2(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + U2_V2(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end
                                                                                                                                   

for i=2:ni-1
for j=1
for k=2:nk-1
U2_V2_filter_2n(i,j,k)= U2_V2_filter_2n(i,j,k)+... 
(U2_V2(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + U2_V2(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
U2_V2(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + U2_V2(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=49
for k=2:nk-1
U2_V2_filter_2n(i,j,k)= U2_V2_filter_2n(i,j,k)+... 
(U2_V2(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + U2_V2(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
U2_V2(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + U2_V2(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=2:nk-1
U2_V2_filter_2n(i,j,k)= U2_V2_filter_2n(i,j,k)+... 
(U2_V2(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U2_V2(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U2_V2(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U2_V2(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U2_V2(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U2_V2(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U2_V2(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U2_V2(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=2:nk-1
U2_V2_filter_2n(i,j,k)= U2_V2_filter_2n(i,j,k)+... 
(U2_V2(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U2_V2(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U2_V2(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U2_V2(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U2_V2(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U2_V2(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U2_V2(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U2_V2(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U2_V2(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U2_V2(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U2_V2(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=1
U2_V2_filter_2n(i,j,k)= U2_V2_filter_2n(i,j,k)+... 
(U2_V2(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U2_V2(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U2_V2(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U2_V2(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U2_V2(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U2_V2(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + U2_V2(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U2_V2(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U2_V2(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U2_V2(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U2_V2(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U2_V2(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U2_V2(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U2_V2(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U2_V2(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
U2_V2_filter_2n(i,j,k)= U2_V2_filter_2n(i,j,k)+... 
(U2_V2(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U2_V2(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U2_V2(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U2_V2(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U2_V2(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U2_V2(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U2_V2(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + U2_V2(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U2_V2(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U2_V2(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U2_V2(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U2_V2(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U2_V2(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U2_V2(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U2_V2(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U2_V2(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U2_V2(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U2_V2(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end



U3_V3(1:ni,1:nj,1:nk)=0;
for k=1:nk
for j=1:nj
for i=1:ni
    U3_V3(i,j,k)=u3_3d(i,j,k)*v3_3d(i,j,k);
end
end
end
U3_V3(i,j,k)=0;
U3_V3_filter_2n = zeros(96,49,96);
for i=2:ni-1
for j=2:nj-1
for k=2:nk-1
U3_V3_filter_2n(i,j,k)= U3_V3_filter_2n(i,j,k)+... 
(U3_V3(i,j,k)*dx*((y(j+1)-y(j-1))/2)*dz + U3_V3(i,j,k-1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + U3_V3(i,j,k+1)*dx*((y(j+1)-y(j-1))/2)*dz/2 + ...
U3_V3(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U3_V3(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U3_V3(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U3_V3(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U3_V3(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U3_V3(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U3_V3(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + U3_V3(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + ...
U3_V3(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + U3_V3(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2)...
/(4*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end
                                                                                                                                   

for i=2:ni-1
for j=1
for k=2:nk-1
U3_V3_filter_2n(i,j,k)= U3_V3_filter_2n(i,j,k)+... 
(U3_V3(i,j,k)*dx*((y(j+1)-y(j))/2)*dz + U3_V3(i,j,k-1)*dx*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i,j,k+1)*dx*((y(j+1)-y(j))/2)*dz/2 + ...
U3_V3(i+1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i-1,j,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i,j+1,k)*(dx)*((y(j+1)-y(j))/2)*dz + U3_V3(i,j+1,k-1)*(dx)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i,j+1,k+1)*(dx)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(4*dx*dz*(y(j+1)-y(j))) ;                                                                                                                                        
end
end
end 

for i=2:ni-1
for j=49
for k=2:nk-1
U3_V3_filter_2n(i,j,k)= U3_V3_filter_2n(i,j,k)+... 
(U3_V3(i,j,k)*dx*((y(j)-y(j-1))/2)*dz + U3_V3(i,j,k-1)*dx*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i,j,k+1)*dx*((y(j)-y(j-1))/2)*dz/2 + ...
U3_V3(i+1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i+1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i+1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i-1,j,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i-1,j,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i-1,j,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i,j-1,k)*(dx)*((y(j)-y(j-1))/2)*dz + U3_V3(i,j-1,k-1)*(dx)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i,j-1,k+1)*(dx)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2) ...
/(4*dx*dz*(y(j)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=1
for j=2:nj-1
for k=2:nk-1
U3_V3_filter_2n(i,j,k)= U3_V3_filter_2n(i,j,k)+... 
(U3_V3(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U3_V3(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U3_V3(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U3_V3(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U3_V3(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U3_V3(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U3_V3(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U3_V3(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=96
for j=2:nj-1
for k=2:nk-1
U3_V3_filter_2n(i,j,k)= U3_V3_filter_2n(i,j,k)+... 
(U3_V3(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U3_V3(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U3_V3(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U3_V3(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz + U3_V3(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U3_V3(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U3_V3(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz + U3_V3(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 + U3_V3(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U3_V3(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz + U3_V3(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2) ...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=1
U3_V3_filter_2n(i,j,k)= U3_V3_filter_2n(i,j,k)+... 
(U3_V3(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U3_V3(i,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U3_V3(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U3_V3(i-1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U3_V3(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U3_V3(i,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + U3_V3(i-1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U3_V3(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U3_V3(i-1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U3_V3(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U3_V3(i+1,j+1,k+1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U3_V3(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U3_V3(i+1,j,k+1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U3_V3(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U3_V3(i+1,j-1,k+1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end

for i=2:ni-1
for j=2:nj-1
for k=96
U3_V3_filter_2n(i,j,k)= U3_V3_filter_2n(i,j,k)+... 
(U3_V3(i,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + U3_V3(i,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 + ...
U3_V3(i-1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U3_V3(i-1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U3_V3(i,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U3_V3(i,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +...
U3_V3(i-1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2  + U3_V3(i-1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2+ ...
U3_V3(i,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 + U3_V3(i,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +...
U3_V3(i-1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U3_V3(i-1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U3_V3(i+1,j+1,k)*(dx/2)*((y(j+1)-y(j))/2)*dz/2 +  U3_V3(i+1,j+1,k-1)*(dx/2)*((y(j+1)-y(j))/2)*dz/2+ ...
U3_V3(i+1,j,k)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +  U3_V3(i+1,j,k-1)*(dx/2)*((y(j+1)-y(j-1))/2)*dz/2 +...
U3_V3(i+1,j-1,k)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 +  U3_V3(i+1,j-1,k-1)*(dx/2)*((y(j)-y(j-1))/2)*dz/2 )...
/(2*dx*dz*(y(j+1)-y(j-1))) ;                                                                                                                                        
end
end
end



for k=1:nk
for j=1:nj
for i=1:ni
TR_1(i,j,k)=U1_V1_filter_2n(i,j,k) - u1_filter_2n(i,j,k)*v1_filter_2n(i,j,k);
TR_2(i,j,k)=U2_V2_filter_2n(i,j,k) - u2_filter_2n(i,j,k)*v2_filter_2n(i,j,k);
TR_3(i,j,k)=U3_V3_filter_2n(i,j,k) - u3_filter_2n(i,j,k)*v3_filter_2n(i,j,k);
end
end
end

TR(1:nj)=0;
for k=1:nk
for i=1:ni
for j=1:nj
TR(j)=TR(j)+((TR_1(i,j,k)+TR_2(i,j,k)+TR_3(i,j,k)))/ni/nk/3;

end
end
end

plot(y,TR);
hold on;
plot(y,Reynolds_uv);
hold on;

